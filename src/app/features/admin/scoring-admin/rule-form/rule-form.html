<div class="rule-form-page">
  <header class="rule-form-header">
    <a [routerLink]="backRoute" class="rule-form-back" aria-label="Back to rules">
      <span class="material-symbols-outlined">arrow_back</span>
    </a>
    <div class="rule-form-header-icon-wrap">
      <span class="material-symbols-outlined">rule</span>
    </div>
    <div>
      <h1 class="rule-form-title">{{ id != null ? 'Edit rule' : 'New rule' }}</h1>
      <p class="rule-form-subtitle">{{ pageSubtitle }}</p>
    </div>
  </header>

  <div *ngIf="loading && id != null" class="rule-form-loading">
    <span class="material-symbols-outlined">progress_activity</span>
    <p>Loading ruleâ€¦</p>
  </div>

  <div *ngIf="error" class="rule-form-error">
    <span class="material-symbols-outlined">error</span>
    <p>{{ error }}</p>
  </div>

  <div class="rule-form-card" *ngIf="!loading || id == null">
    <div class="rule-form-card-inner">
      <form (ngSubmit)="save()">
        <p class="rule-form-section-title">Required</p>
        <div class="rule-form-group">
          <label class="rule-form-label" for="ruleName">{{ labelRuleName }}</label>
          <input id="ruleName" type="text" [(ngModel)]="ruleName" name="ruleName" [placeholder]="placeholderRuleName" class="rule-form-input" />
        </div>
        <div class="rule-form-group">
          <label class="rule-form-label" for="ruleType">{{ labelRuleType }}</label>
          <select id="ruleType" [(ngModel)]="ruleType" name="ruleType" class="rule-form-select">
            <option *ngFor="let opt of typeOptions" [value]="opt.value">{{ opt.label }}</option>
          </select>
        </div>
        <div class="rule-form-group">
          <label class="rule-form-label" for="points">{{ labelPoints }}</label>
          <input id="points" type="number" [(ngModel)]="points" name="points" min="1" max="1000" [placeholder]="placeholderPoints" class="rule-form-input" />
        </div>

        <p class="rule-form-section-title mt">Details</p>
        <div class="rule-form-group">
          <label class="rule-form-label optional" for="description">{{ labelDescription }}</label>
          <textarea id="description" rows="3" [(ngModel)]="description" name="description" [placeholder]="placeholderDescription" class="rule-form-textarea"></textarea>
        </div>

        <p class="rule-form-section-title mt">Optional (type-specific)</p>
        <div class="rule-form-row">
          <div class="rule-form-group">
            <label class="rule-form-label optional" for="depositThreshold">{{ labelDepositThreshold }}</label>
            <input id="depositThreshold" type="number" [(ngModel)]="depositThreshold" name="depositThreshold" min="0" step="0.01" [placeholder]="placeholderDeposit" class="rule-form-input" />
          </div>
          <div class="rule-form-group">
            <label class="rule-form-label optional" for="maxGuarantees">{{ labelMaxGuarantees }}</label>
            <input id="maxGuarantees" type="number" [(ngModel)]="maxGuaranteesPerUser" name="maxGuaranteesPerUser" min="1" max="10" [placeholder]="placeholderMaxGuarantees" class="rule-form-input" />
          </div>
        </div>
        <div class="rule-form-group">
          <label class="rule-form-label optional" for="guaranteePoints">{{ labelGuaranteePoints }}</label>
          <input id="guaranteePoints" type="number" [(ngModel)]="guaranteePoints" name="guaranteePoints" min="1" max="100" [placeholder]="placeholderGuaranteePoints" class="rule-form-input" />
        </div>

        <div class="rule-form-actions">
          <button type="submit" [disabled]="loading" class="rule-form-btn-primary">
            <span class="material-symbols-outlined" style="font-size: 1.125rem;">save</span>
            {{ saveLabel }}
          </button>
          <a [routerLink]="cancelRoute" class="rule-form-btn-secondary">{{ cancelLabel }}</a>
        </div>
      </form>
    </div>
  </div>
</div>
