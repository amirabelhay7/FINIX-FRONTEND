<div class="rules-admin-page">
  <header class="rules-header">
    <div class="rules-header-left">
      <div class="rules-header-icon-wrap">
        <span class="material-symbols-outlined">rule</span>
      </div>
      <div>
        <h1 class="rules-title">{{ pageTitle }}</h1>
        <p class="rules-subtitle">{{ pageSubtitle }}</p>
      </div>
    </div>
    <a [routerLink]="addRuleRoute" class="rules-add-btn">
      <span class="material-symbols-outlined">add</span>
      {{ addRuleLabel }}
    </a>
  </header>

  <div *ngIf="loading" class="rules-loading">
    <span class="material-symbols-outlined">progress_activity</span>
    <p>Loading rulesâ€¦</p>
  </div>

  <div *ngIf="!loading && error" class="rules-error">
    <span class="material-symbols-outlined">error</span>
    <p>{{ error }}</p>
    <button type="button" class="rules-retry" (click)="loadRules()">Retry</button>
  </div>

  <ng-container *ngIf="!loading && !error">
    <div class="rules-stats">
      <div class="rules-stat">
        <p class="rules-stat-value">{{ rules.length }}</p>
        <p class="rules-stat-label">Total rules</p>
      </div>
      <div class="rules-stat">
        <p class="rules-stat-value">{{ activeRulesCount }}</p>
        <p class="rules-stat-label">Active</p>
      </div>
    </div>

    <div class="rules-card">
      <div class="rules-toolbar">
        <div class="rules-search-wrap">
          <span class="material-symbols-outlined">search</span>
          <input type="text" [(ngModel)]="searchText" [placeholder]="searchPlaceholder" class="rules-search-input" />
        </div>
        <select [(ngModel)]="typeFilter" class="rules-filter-select">
          <option *ngFor="let opt of typeFilterOptions" [value]="opt.value">{{ opt.label }}</option>
        </select>
      </div>
      <div class="rules-table-wrap">
        <table class="rules-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Rule name</th>
              <th>Type</th>
              <th>Points</th>
              <th>Status</th>
              <th class="text-right">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of filteredRows">
              <td class="rules-cell-id">{{ row.id }}</td>
              <td class="rules-cell-name">{{ row.ruleName }}</td>
              <td>{{ row.type }}</td>
              <td class="rules-cell-points">{{ row.points }}</td>
              <td>
                <span class="rules-pill" [ngClass]="row.status === 'Active' ? 'rules-pill-active' : 'rules-pill-inactive'">{{ row.status }}</span>
              </td>
              <td>
                <div class="rules-actions">
                  <a [routerLink]="row.editRoute" class="rules-action-link">{{ editLabel }}</a>
                  <button type="button" class="rules-action-btn" [ngClass]="row.status === 'Active' ? 'rules-action-btn-red' : 'rules-action-btn-green'">{{ row.actionLabel }}</button>
                  <button type="button" class="rules-action-btn rules-action-btn-red" (click)="deleteRule(row.id, $event)">{{ deleteLabel }}</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <p *ngIf="filteredRows.length === 0" class="rules-empty">No rules match your filters.</p>
    </div>
  </ng-container>
</div>
